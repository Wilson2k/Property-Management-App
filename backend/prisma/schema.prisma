// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id         Int        @id @default(autoincrement())
  firstName  String     @db.Text
  lastName   String     @db.Text
  email      String     @unique @db.Text
  password   String     @db.Text
  properties Property[]
  tenants    Tenant[]
}

model Tenant {
  id         Int        @id @default(autoincrement())
  firstName  String     @db.Text
  lastName   String     @db.Text
  email      String     @unique @db.Text
  phone      String     @unique @db.Text
  user       User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId     Int
  properties Property[]
  tickets    Ticket[]
}

model Ticket {
  id         Int      @id @default(autoincrement())
  type       String   @db.Text
  open       Boolean  @default(true)
  details    String   @db.Text
  openDate   String   @db.Text
  closeDate  String?  @db.Text
  tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  tenantId   Int
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  propertyId Int
}

model Property {
  id      Int      @id @default(autoincrement())
  address String   @db.Text
  city    String   @db.Text
  state   String   @db.Text
  type    String   @db.Text
  size    String   @db.Text
  images  String[] @db.Text
  owner   User     @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  ownerId Int
  tenants Tenant[]
  tickets Ticket[]

  @@unique([address,city,state])
}
